這是一份為你準備的技術簡報。這套工具是你針對 **AliceSW 小說網** 的反爬蟲機制（登入權限、Session 校驗、頻率限制）所開發的自動化下載方案。

---

## 🛠️ 程式：AliceSW 小說自動化下載器 (JSON 整合版)

### 1. 核心設計理念

* **身分偽裝**：利用瀏覽器插件導出的 `cookie.json` 直接模擬真實用戶登入狀態，規避複雜的登入驗證。
* **智慧解析**：自動偵測目錄 URL（從 Cookie 歷史中提取）並過濾非小說章節的無效連結。
* **極低威脅性**：內建「慢速模擬」機制，以 5-10 秒的隨機間隔請求，降低被伺服器封鎖 IP 的風險。

### 2. 前置作業清單

1. **環境依賴**：`pip install requests beautifulsoup4`。
2. **憑證獲取**：
* 開啟瀏覽器登入網站。
* 點擊 **Cookie-Editor** 插件 -> **Export (JSON)**。
* 將內容存為同目錄下的 **`cookie.json`**。


3. **檔案連結**：確保 `cookie.json` 與主程式 `final_downloader.py` 放在同一個資料夾。

---

### 3. 重點參數調整 (`config`)

當小說更新或網站結構微調時，只需檢查腳本上方的變數：

| 參數 | 說明 | 建議設定 |
| --- | --- | --- |
| **`NOVEL_NAME`** | 存檔的 TXT 檔名 | 依小說名稱自訂 |
| **`SKIP_COUNT`** | 跳過目錄開頭的無效連結 | 預設 **2**（避開導航列） |
| **`MIN/MAX_DELAY`** | 請求間隔（秒） | **5 ~ 8**（安全且穩健） |

---

### 4. 運作流程圖

1. **讀取與轉換**：程式啟動後自動將 JSON 格式轉為 Python Requests 可用的 `Cookie String`。
2. **目錄掃描**：根據網址特徵（如 `/book/`）自動篩選出真正的章節列表。
3. **循環下載**：逐章爬取，若單章失敗會自動重試 3 次，確保內容完整。
4. **內容清洗**：自動剔除內文中的 `<script>`、`<style>` 及廣告 `<iframe>` 標籤，僅保留純文字。

---

### 5. 常見問題 (Troubleshooting)

* **出現 403 錯誤**：代表 Cookie 已過期。請在瀏覽器重新整理網頁，再導出一次 JSON 覆蓋舊檔即可。
* **抓不到內容**：若網站改版，需檢查 `soup.select_one` 裡的選擇器（如 `#content`）是否仍與網站 HTML 結構一致。
* **中斷續傳**：本程式採用 `open(..., "a")` 追加模式，若下載中斷，你可以手動調整 `SKIP_COUNT` 後重新啟動，它會接著往下寫。
